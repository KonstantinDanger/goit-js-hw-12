{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const hitsPerPage = 15;\n\nconst API_KEY = '49409178-3b63951a4472504068603616d';\nconst url = 'https://pixabay.com/api/';\n\nexport default async function fetchImages(query, pageIndex) {\n  try {\n    const response = await axios.get(url, {\n      params: {\n        key: API_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: hitsPerPage,\n        page: pageIndex,\n        q: query,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.log('error', error);\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function responseError(\n  message = `Sorry, there are no images matching your search query. Please try again!`\n) {\n  iziToast.error({\n    message: message,\n    position: 'topRight',\n    timeout: 3000,\n  });\n}\n\nexport function resetForm() {\n  document.querySelector('.form').reset();\n}\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n\n  const markup = images\n    .map(image => {\n      return createImageItem(image);\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n  setTimeout(() => {\n    scroll();\n  }, 100);\n}\n\nexport function setLoadMoreButton(active) {\n  const btn = document.querySelector('.loadMoreButton');\n  const list = btn.classList;\n  active ? list.remove('hidden') : list.add('hidden');\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.add('hidden');\n}\n\nexport function clearGallery() {\n  document.querySelector('.gallery').textContent = '';\n}\n\nexport function scroll() {\n  const galleryCardHeight =\n    document.querySelector('.galleryItem').getBoundingClientRect().height * 2;\n  console.log('galleryCardHeight', galleryCardHeight);\n  scrollBy({\n    top: galleryCardHeight,\n    behavior: 'smooth',\n  });\n}\n\nfunction createImageItem(image) {\n  return `\n    <li class=\"galleryItem\">\n        <a href=\"${image.largeImageURL}\" disabled=\"true\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\"/>\n        </a>\n        <div class=\"imageInfoContainer\">\n            <div class=\"imageInfo\">\n                Likes \n                <div>\n                    ${image.likes}\n                </div>\n            </div>\n            <div class=\"imageInfo\">\n                Views \n                <div>\n                    ${image.views}\n                </div>\n            </div>\n            <div class=\"imageInfo\">\n                Comments \n                <div>\n                    ${image.comments}\n                </div>\n            </div>\n            <div class=\"imageInfo\">\n                Downloads\n                <div>\n                ${image.downloads}\n                </div>\n            </div>\n        </div>\n    </li>`;\n}\n","import pixabayApi, { hitsPerPage } from './js/pixabay-api';\nimport {\n  clearGallery,\n  hideLoader,\n  renderGallery,\n  resetForm,\n  responseError,\n  showLoader,\n  setLoadMoreButton,\n  scroll,\n} from './js/render-functions';\n\nconst inputField = document.querySelector(\"[type='text']\");\nconst form = document.querySelector('.form');\nconst loadButton = document.querySelector('.loadMoreButton');\n\nlet input;\nlet page = 1;\nlet currentQuery = '';\n\nconst isInputvalid = input => {\n  return input.trim() !== '';\n};\n\nconst handleSubmit = async (event, input) => {\n  event.preventDefault();\n  if (!isInputvalid(input) || input === currentQuery) {\n    inputField.value = '';\n    return;\n  }\n\n  if (input !== currentQuery) {\n    page = 1;\n  }\n\n  currentQuery = input;\n  showLoader();\n  clearGallery();\n  handleLoad(input, page);\n};\n\nconst handleLoad = async (query, page) => {\n  try {\n    const data = await pixabayApi(query, page);\n    const hits = data.hits;\n\n    if (hits.length === 0) {\n      responseError();\n      setLoadMoreButton(false);\n\n      return;\n    }\n\n    const totalHits = data.totalHits;\n    const loadedHits = page * hitsPerPage;\n    const noResultsLeft = loadedHits >= totalHits;\n\n    if (noResultsLeft) {\n      responseError(\n        `We're sorry, but you've reached the end of search results.`\n      );\n      setLoadMoreButton(false);\n      return;\n    }\n\n    setLoadMoreButton(true);\n    renderGallery(hits);\n  } catch (error) {\n    console.log('error', error);\n  } finally {\n    hideLoader();\n    resetForm();\n  }\n};\n\nconst handleLoadMore = async (event, query) => {\n  event.preventDefault();\n  page++;\n  handleLoad(query, page);\n};\n\nform.addEventListener('submit', event => handleSubmit(event, input));\nloadButton.addEventListener('click', event =>\n  handleLoadMore(event, currentQuery)\n);\ninputField.addEventListener('input', e => {\n  input = e.target.value;\n});\n"],"names":["hitsPerPage","API_KEY","url","fetchImages","query","pageIndex","axios","error","lightbox","SimpleLightbox","responseError","message","iziToast","resetForm","renderGallery","images","gallery","markup","image","createImageItem","scroll","setLoadMoreButton","active","list","showLoader","hideLoader","clearGallery","galleryCardHeight","inputField","form","loadButton","input","page","currentQuery","isInputvalid","handleSubmit","event","handleLoad","data","pixabayApi","hits","totalHits","handleLoadMore"],"mappings":"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"}